<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Home</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Home</h1>

    



    


    <h3> </h3>










    




    <section>
        <article><h1>Language DHIS2 <a href="https://travis-ci.org/OpenFn/language-dhis2"><img src="https://travis-ci.org/OpenFn/language-dhis2.svg?branch=main" alt="Build Status"></a></h1>
<p>Language Pack for building expressions and operations for working with the
<a href="http://dhis2.github.io/dhis2-docs/master/en/developer/html/dhis2_developer_manual.html">DHIS2 API</a>.</p>
<h2>Documentation</h2>
<p>View the <a href="https://openfn.github.io/language-dhis2/">docs site</a> for full
technical documentation and <strong>lots of examples</strong> for how to use the various
helper functions.</p>
<h2>Sample State</h2>
<pre class="prettyprint source lang-json"><code>{
  &quot;configuration&quot;: {
    &quot;username&quot;: &quot;admin&quot;,
    &quot;password&quot;: &quot;district&quot;,
    &quot;hostUrl&quot;: &quot;https://play.dhis2.org/2.36.6&quot;
  },
  &quot;data&quot;: { &quot;a&quot;: 1, &quot;b&quot;: 2 }
}
</code></pre>
<h2>Development</h2>
<p>Clone the repo and run <code>npm install</code>.</p>
<p>Run tests using <code>npm run test</code> or <code>npm run test:watch</code>. (NB: that this repo also
contain integration tests which can be run with <code>npm run integration-test</code>.)</p>
<p><strong><em>Make your changes to the files in <code>src/</code> and then use <code>npm run build</code> to
generate output files in <code>lib/</code>.</em></strong></p>
<h3>Unit Tests</h3>
<p>Unit tests allows to test the functionalities of the adaptor helper functions
such as:</p>
<blockquote>
<p>Does <code>create('events', payload)</code> perform a post request to the correct DHIS2
API?</p>
</blockquote>
<p>To run unit tests execute <code>npm run test</code> (they're the default tests).</p>
<p>Anytime a new functionality is added to the helper functions, more unit tests
needs to be added.</p>
<h3>End-to-end integration tests</h3>
<p>Integration tests allow us to test the end-to-end behavior of the helper
functions and also to test the examples we provide via inline documentation.</p>
<p>For example with integration tests we answer the following question:</p>
<blockquote>
<p>Does <code>create('events', eventPayload)</code> actually create a new event in a live
DHIS2 system?</p>
</blockquote>
<p>To run integration tests, execute <code>npm run integration-test</code>. These tests use
network I/O and a public connection to a DHIS2 &quot;play&quot; server so their timing and
performance is unpredictable. Consider adding an increased timeout, and
modifying the orgUnit, program, etc., IDs set in <code>globalState</code>.</p>
<h4>Troubleshooting the tests</h4>
<ul>
<li>
<p>Depending on your internet strength please consider changing the <strong>global
timeout</strong> in the <code>test/mocha.opts</code> file to avoid faillures related to network
timeouts.</p>
</li>
<li>
<p>The behavior of the tests in <code>test/integration.js</code> is very unpredictable; they
depend on the <strong>configuration of a target DHIS2 instance</strong>. Currently you need
to have at least one organisation unit with one program, one
trackedEntityInstance and one programStage in it. These components need to be
well configured for the integration tests to work. For example: the
trackedEntityInstance need to be enrolled to the program, which should be
created in that organisation unit and contains at least that programStage. If
the tests fail, you must adjust these attributes in the
<a href="test/integration.js">before hook</a>:</p>
</li>
</ul>
<pre class="prettyprint source lang-javascript"><code>before(done => {
  fixture.initialState = {
    configuration: {
      username: 'admin',
      password: 'district',
      hostUrl: 'https://play.dhis2.org/2.36.6',
    },
    program: 'IpHINAT79UW',
    orgUnit: 'DiszpKrYNg8',
    trackedEntityInstance: 'uhubxsfLanV',
    programStage: 'eaDHS084uMp',
  };
  done();
});
</code></pre>
<ul>
<li>Make sure the <code>update</code> and <code>upsert</code> integration tests don't affect those
initial organisation units, programs, programStage and trackedEntityInstance
required. Otherwise the create integration tests would be broken again; and
that's an endless faillure loop :(</li>
</ul>
<p>Anytime a new example is added in the documentation of a helper function, a new
integration test should be built.</p></article>
    </section>






</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Adaptor.html">Adaptor</a></li></ul><h3>Classes</h3><ul><li><a href="module-Adaptor-configMigrationHelper.html">configMigrationHelper</a></li><li><a href="module-Adaptor-execute.html">execute</a></li></ul><h3>Global</h3><ul><li><a href="global.html#request">request</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Thu Dec 23 2021 06:44:11 GMT-0700 (Mountain Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>